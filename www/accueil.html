<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="default-src 'self' data:* gap://* tel:* 'unsafe-inline' 'unsafe-eval' https://pagespro.cm; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:; connect-src *" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel="stylesheet" type="text/css" href="css/index.css">
		<link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
		<link rel="stylesheet" href="assets/css/styles.css">
		<link rel="stylesheet" href="assets/css/fonts.css">
        <title>Pagespro</title>
		<style>
			/* Android */
			/*
			body
			{
				position: fixed;
				top: 0px;
				left: 0px;
				width: 100%;
				height:100%;
				overflow: hidden;
			}
			.page_accueil
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100%;
				height:100%;
				overflow: hidden;
				background: #ffffff;
				text-align: left;
				padding-left: 20px;
				padding-right: 20px;
				padding-top: 50px;
				opacity: 0;
				transition: opacity 0.8s;
			}
			
			/* iOS */
			
			body
			{
				position: fixed;
				top: 0px;
				left: 0px;
				width: 100%;
				height:100%;
				overflow: hidden;
			}
			.page_accueil
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100%;
				height:100%;
				overflow: hidden;
				background: #ffffff;
				text-align: left;
				opacity: 0;
				transition: opacity 0.8s;
			}
			.pagespro-modal-msg
			{
				position: absolute;
				width: 200px;
				height: 150px;
				background: #fff;
				top: calc(300vw + 10px);
				left: calc(50vw - 100px);
				transition: margin-top 0.5s;
				border-radius: 8px;
				text-align: center;
				padding: 30px 10px;
			}
			.close-box
			{
				font-family: "Product Regular";
				color: #393939;
				font-size: 12px;
			}
			.btn-ok
			{
				background: #000000;
				border-radius: 25px;
				color: #ffffff;
				font-size: 14px;
				width: 50px;
				padding: 3px 0px;
				margin-top: 20px;
			}
			.c-terminale
			{
				font-family: "Product Medium";
				color: #393939;
				font-size: 12px;
			}
			.menu-app
			{
				position: absolute;
				bottom: 0px;
				left: 0px;
				width: 100%;
				height: 50px;
				background: #ffffff;
				box-shadow: 0px -1px 3px 0px rgba(153,153,153,0.3);
				transition: bottom 0.8s;
			}
			.menu
			{
				position: absolute;
				height: 50px;
				width: 20%;
				text-align: center;
				padding-top: 5px;
			}
			.menu img
			{
				height: 25px;
				width: 25px;
			}
			.text-menu
			{
				font-family: "Cereal Medium";
				font-size: 8px;
				color: #9c9c9c;
			}
			.text-active
			{
				color: #3c3c3c;
			}
			.m-home
			{
				bottom: 0px;
				left: 0px;
			}
			.m-carte
			{
				bottom: 0px;
				left: 20%;
			}
			.m-historique
			{
				bottom: 0px;
				left: 40%;
			}
			.m-pages
			{
				bottom: 0px;
				left: 60%;
			}
			.m-plus
			{
				bottom: 0px;
				left: 80%;
			}
			
			.page
			{
				position: absolute;
				top: 0px;
				left: 100vw;
				width: 100vw;
				height: calc(100vh - 50px);
				transition: left 0.3s;
			}
			.page-active
			{
				left: 0px;
				transition: left 0.3s;
			}
			
			.accueil-index
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100%;
				height: calc(100vh - 50px);
				background: #fff;
				text-align: center;
				vertical-align: middle;
				transition: opacity 0.3s;
			}
			.accueil-index-logo
			{
				margin-top: calc(50vh - 100px);
			}
			.accueil-index-logo img
			{
				width: 50px;
				height: 50px;
				margin-bottom: 20px;
			}
			.accueil-index-recherche
			{
				margin: 0 auto;
				width: 80%;
				min-width: 280px;
				border: 1px solid #dfe1e5;
				border-radius: 25px;
				height: 38px;
				text-align: center;
				padding-top: 3px;
			}
			.loupe-accueil
			{
				border: none;
				width: 27px;
				height: 27px;
				background: #e5c304;
				border-radius: 50%;
				color: #393939;
				font-family: 24px;
				text-align: center;
				display: inline-block;
			}
			.accueil-index-champ
			{
				width: calc(100% - 48px);
				margin-left: 10px;
				font-family: "Product Regular";
				font-size: 16px;
				border: none;
				color: #999;
			}
			
			.accueil-haut-recherche
			{
				position: absolute;
				top: 0px;
				left: 0px;
				width: 100%;
				height: 50px;
				background: #fff;
				text-align: center;
				opacity: 0;
				transition: opacity 0.3s;
				border-bottom: 1px solid #dfe1e5;
				padding: 10px;
				font-size: 18px;
				transition: opacity 0.3s;
			}
			.accueil-haut-recherche input
			{
				width: calc(100% - 50px);
				padding-left: 10px;
				font-size: 13px;
				border: none;
			}
			.accueil-haut-recherche .fa-arrow-left
			{
				color: #9c9c9c;
			}
			.accueil-haut-recherche .fa-times-circle
			{
				color: #333333;
			}
		</style>
    </head>
    <body>
		
		<div class="page_accueil">
			<div class="page page-recherche page-active">
				
				<div class="accueil-haut-recherche">
					<i class="fa fa-arrow-left accueil-btn-retour"></i>
					<input type="text" class="champ-recherche txt-rechercher" id="champ-recherche" placeholder="Que recherchez-vous?" />
					<i class="fa fa-times-circle accueil-btn-efface"></i>
				</div>
				
				<div class="accueil-index">
					<div class="accueil-index-logo"><img src="img/logo.png" /></div>
					<div class="accueil-index-recherche">
						<input type="text" class="accueil-index-champ txt-rechercher" placeholder="Que recherchez-vous?" />
						<div class="loupe-accueil"><i class="fa fa-search"></i></div>
					</div>
				</div>
				
			</div>
			<div class="page page-cartes">
				Cartes
			</div>
			<div class="page page-historique">
				Historique
			</div>
			<div class="page page-pages">
				Pages
			</div>
			<div class="page page-plus">
				Plus
			</div>
			
			<div class="menu-app">
				<div class="menu m-home">
					<img src="assets/ico/on/i-recherche.png" />
					<div class="text-menu text-active txt-accueil">Accueil</div>
				</div>
				<div class="menu m-carte">
					<img src="assets/ico/off/i-cartes.png" />
					<div class="text-menu txt-carte">Carte</div>
				</div>
				<div class="menu m-historique">
					<img src="assets/ico/off/i-historique.png" />
					<div class="text-menu txt-historique">Historique</div>
				</div>
				<div class="menu m-pages">
					<img src="assets/ico/off/i-pages.png" />
					<div class="text-menu txt-pages">Mes Pages</div>
				</div>
				<div class="menu m-plus">
					<img src="assets/ico/off/i-plus.png" />
					<div class="text-menu txt-plus">Plus</div>
				</div>
			</div>
		</div>
		
		<!-- Pagespro Modals -->
		<div class="pagespro-modal-rideau"></div>
		<div class="pagespro-modal-msg">
			<div class="close-box">
				<span class="">Ce numéro est désormais associé au terminale : </span> <span class="c-terminale" id="device"></span>
			</div>
			<div class="btn btn-ok ">OK</div>
		</div>
        
		<div id="wait" class="page_wait">
			<img src="assets/img/wait.gif" />
		</div>
		
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/bootstrap/js/bootstrap.min.js"></script>
		<script src="assets/js/jquery.bcSwipe.js"></script>
		<script src="assets/js/script.js"></script>
		<script src="assets/lang/lang_en.js"></script>
		<script src="assets/lang/lang_fr.js"></script>
		<script>
			is_accueil = localStorage["is_accueil"];
			if(is_accueil != '1')
			{ 
				window.location.href = 'connexion.html'; 
			}
			
			var lang = localStorage["lang"];
			var var_texte = '';
			if(lang == 'fr'){ var_texte = accueil_text_fr; } else { var_texte = accueil_text_en; }
			
			//Les textes traduits
			$('.txt-accueil').html(var_texte["accueil"]);
			$('.txt-carte').html(var_texte["carte"]);
			$('.txt-historique').html(var_texte["historique"]);
			$('.txt-pages').html(var_texte["pages"]);
			$('.txt-plus').html(var_texte["plus"]);
			$('.txt-rechercher').attr("placeholder",var_texte["recherchez"]);
			$('.champ-recherche').attr("placeholder",var_texte["recherchez"]);
			
			$(window).on('load', function() {
				$("#wait").hide();
				$(".page_accueil").css("opacity","1");
			});
			
			setInterval(test_device, 5000);
			function test_device()
			{
				$phone = localStorage["numero"];
				
				$.ajax({
					method: "POST",
					url: SERVER_API + "mobile/get_user_by_number/",
					data: { numero: $phone }
				})
				.done(function( msg ) {
					server = JSON.parse(msg);
					if(server.retour == "OK")
					{
						if(msg != localStorage["server"])
						{
							$info_user = server.user;
							$user_device = $info_user.device;
							$("#device").html($user_device.marque + " " + $user_device.model);
							if($user_device.uuid != localStorage["device_uuid"])
							{
								OpenModalMSG();
								localStorage['is_accueil'] = '0';
								localStorage['numero'] = '';
								localStorage['server'] = '';
							}
						}
						//localStorage["server"] = msg;
					}
				});
			}
			
			$(".btn-ok").click(function(){
				CloseModalMSG();
				window.location.href = 'connexion.html';
			});
			
			function OpenModalMSG()
			{
				$('.pagespro-modal-rideau').show();
				$('.pagespro-modal-msg').css("top", "calc(50vh - 75px)");
			}
			function CloseModalMSG()
			{
				$('.pagespro-modal-msg').css("top", "calc(300vh + 10px)");
				$('.pagespro-modal-rideau').hide();
			}
			
			$(".m-home").click(function(){
				$(".page").removeClass("page-active");
				$(".text-menu").removeClass("text-active");
				$(".m-carte img").attr("src", "assets/ico/off/i-cartes.png");
				$(".m-historique img").attr("src", "assets/ico/off/i-historique.png");
				$(".m-pages img").attr("src", "assets/ico/off/i-pages.png");
				$(".m-plus img").attr("src", "assets/ico/off/i-plus.png");
				
				$(".m-home img").attr("src", "assets/ico/on/i-recherche.png");
				$(".m-home .text-menu").addClass("text-active");
				$(".page-recherche").addClass("page-active");
			});
			$(".m-carte").click(function(){
				$(".page").removeClass("page-active");
				$(".text-menu").removeClass("text-active");
				$(".m-home img").attr("src", "assets/ico/off/i-recherche.png");
				$(".m-historique img").attr("src", "assets/ico/off/i-historique.png");
				$(".m-pages img").attr("src", "assets/ico/off/i-pages.png");
				$(".m-plus img").attr("src", "assets/ico/off/i-plus.png");
				
				$(".m-carte img").attr("src", "assets/ico/on/i-cartes.png");
				$(".m-carte .text-menu").addClass("text-active");
				$(".page-cartes").addClass("page-active");
			});
			$(".m-historique").click(function(){
				$(".page").removeClass("page-active");
				$(".text-menu").removeClass("text-active");
				$(".m-home img").attr("src", "assets/ico/off/i-recherche.png");
				$(".m-carte img").attr("src", "assets/ico/off/i-cartes.png");
				$(".m-pages img").attr("src", "assets/ico/off/i-pages.png");
				$(".m-plus img").attr("src", "assets/ico/off/i-plus.png");
				
				$(".m-historique img").attr("src", "assets/ico/on/i-historique.png");
				$(".m-historique .text-menu").addClass("text-active");
				$(".page-historique").addClass("page-active");
			});
			$(".m-pages").click(function(){
				$(".page").removeClass("page-active");
				$(".text-menu").removeClass("text-active");
				$(".m-home img").attr("src", "assets/ico/off/i-recherche.png");
				$(".m-carte img").attr("src", "assets/ico/off/i-cartes.png");
				$(".m-historique img").attr("src", "assets/ico/off/i-historique.png");
				$(".m-plus img").attr("src", "assets/ico/off/i-plus.png");
				
				$(".m-pages img").attr("src", "assets/ico/on/i-pages.png");
				$(".m-pages .text-menu").addClass("text-active");
				$(".page-pages").addClass("page-active");
			});
			$(".m-plus").click(function(){
				$(".page").removeClass("page-active");
				$(".text-menu").removeClass("text-active");
				$(".m-home img").attr("src", "assets/ico/off/i-recherche.png");
				$(".m-carte img").attr("src", "assets/ico/off/i-cartes.png");
				$(".m-historique img").attr("src", "assets/ico/off/i-historique.png");
				$(".m-pages img").attr("src", "assets/ico/off/i-pages.png");
				
				$(".m-plus img").attr("src", "assets/ico/on/i-plus.png");
				$(".m-plus .text-menu").addClass("text-active");
				$(".page-plus").addClass("page-active");
			});
			
			$(".accueil-index-champ").click(function(){
				$(".accueil-index").css("opacity","0");
				$(".accueil-index").hide();
				
				$(".accueil-haut-recherche").show();
				$(".accueil-haut-recherche").css("opacity","1");
				var searchInput = $('#champ-recherche');
				searchInput.putCursorAtEnd().on("focus", function() { searchInput.putCursorAtEnd()});
			});
			
			$(".accueil-btn-retour").click(function(){
				if($('#champ-recherche').val() == "")
				{
					$(".accueil-haut-recherche").css("opacity","0");
					$(".accueil-haut-recherche").hide();
					
					$(".accueil-index").show();
					$(".accueil-index").css("opacity","1");
				}
			});
			
			$(".accueil-btn-efface").click(function(){
				$('#champ-recherche').val("");
				$('#champ-recherche').focus();
			});
			
		</script>
    </body>
</html>
